{
	"project": "headless-framework",
	"branchName": "xshaheen/feat-unified-messaging-system",
	"description": "Unify Headless.Ticker + Headless.Messaging into Single Messaging System",
	"userStories": [
		{
			"id": "US-001",
			"title": "Create ScheduledTrigger message type",
			"description": "Create ScheduledTrigger message type in Abstractions as the marker type for scheduled/recurring job triggers",
			"size": "S",
			"acceptanceCriteria": [
				"ScheduledTrigger record contains ScheduledTime, JobName, Attempt properties",
				"Optional CronExpression, ParentJobId, Payload properties included",
				"XML documentation complete"
			],
			"priority": 1,
			"phase": 1,
			"passes": false,
			"notes": ""
		},
		{
			"id": "US-002",
			"title": "Create IDirectPublisher interface",
			"description": "Create IDirectPublisher interface in Abstractions for fire-and-forget publishing that bypasses outbox",
			"size": "S",
			"acceptanceCriteria": [
				"PublishAsync<T> method throws on failure",
				"TryPublishAsync<T> returns DirectPublishResult",
				"Supports both explicit topic and topic mapping",
				"XML documentation complete"
			],
			"priority": 1,
			"phase": 1,
			"passes": false,
			"notes": ""
		},
		{
			"id": "US-003",
			"title": "Create RecurringAttribute",
			"description": "Create RecurringAttribute in Abstractions for marking IConsume<ScheduledTrigger> handlers as recurring jobs",
			"size": "S",
			"acceptanceCriteria": [
				"Supports 6-field cron expression",
				"Optional Name, TimeZone, RetryIntervals, SkipIfRunning properties",
				"XML documentation complete"
			],
			"priority": 1,
			"phase": 1,
			"passes": false,
			"notes": ""
		},
		{
			"id": "US-004",
			"title": "Implement DirectPublisher for RabbitMQ",
			"description": "Implement DirectPublisher in Core that sends directly to RabbitMQ transport, bypassing outbox",
			"size": "M",
			"acceptanceCriteria": [
				"Sends to RabbitMQ without storing in outbox",
				"Throws exception on send failure",
				"Supports topic mapping",
				"< 5ms latency overhead vs direct transport call"
			],
			"priority": 1,
			"phase": 1,
			"passes": false,
			"notes": ""
		},
		{
			"id": "US-005",
			"title": "Add EnableDirectPublish to MessagingOptions",
			"description": "Add EnableDirectPublish() method to MessagingOptions to opt-in to direct publishing",
			"size": "S",
			"acceptanceCriteria": [
				"EnableDirectPublish() registers IDirectPublisher in DI",
				"Disabled by default",
				"Works with all configured transports"
			],
			"priority": 1,
			"phase": 1,
			"passes": false,
			"notes": ""
		},
		{
			"id": "US-006",
			"title": "Add OpenTelemetry for direct publish",
			"description": "Add OpenTelemetry instrumentation for direct publish operations",
			"size": "S",
			"acceptanceCriteria": [
				"Creates span for each direct publish",
				"Records success/failure status",
				"Includes topic, message type, duration"
			],
			"priority": 2,
			"phase": 1,
			"passes": false,
			"notes": ""
		},
		{
			"id": "US-007",
			"title": "Write DirectPublisher unit tests",
			"description": "Write comprehensive unit tests for DirectPublisher implementation",
			"size": "M",
			"acceptanceCriteria": [
				"Tests success path",
				"Tests failure/exception handling",
				"Tests topic mapping resolution",
				">= 85% coverage"
			],
			"priority": 1,
			"phase": 1,
			"passes": false,
			"notes": ""
		},
		{
			"id": "US-008",
			"title": "Write DirectPublisher RabbitMQ integration tests",
			"description": "Write integration tests for DirectPublisher with RabbitMQ using Testcontainers",
			"size": "M",
			"acceptanceCriteria": [
				"Tests real message delivery to RabbitMQ",
				"Tests connection failure scenarios",
				"Uses Testcontainers for RabbitMQ"
			],
			"priority": 1,
			"phase": 1,
			"passes": false,
			"notes": ""
		},
		{
			"id": "US-009",
			"title": "Create unified scheduled_jobs schema",
			"description": "Create scheduled_jobs table schema in PostgreSql provider replacing Ticker entities",
			"size": "M",
			"acceptanceCriteria": [
				"Schema includes all fields from design",
				"Indexes for NextRunTime and LockHolder queries",
				"Migration script created"
			],
			"priority": 1,
			"phase": 2,
			"passes": false,
			"notes": ""
		},
		{
			"id": "US-010",
			"title": "Create job_executions schema",
			"description": "Create job_executions table schema for tracking individual job runs",
			"size": "S",
			"acceptanceCriteria": [
				"Foreign key to scheduled_jobs with CASCADE delete",
				"Indexes for JobId+Status queries",
				"Migration script created"
			],
			"priority": 1,
			"phase": 2,
			"passes": false,
			"notes": ""
		},
		{
			"id": "US-011",
			"title": "Create IScheduledJobStorage abstraction",
			"description": "Create IScheduledJobStorage interface for scheduled job persistence operations",
			"size": "M",
			"acceptanceCriteria": [
				"CRUD operations for jobs",
				"Query for due jobs",
				"Execution tracking methods",
				"Lock acquisition/release"
			],
			"priority": 1,
			"phase": 2,
			"passes": false,
			"notes": ""
		},
		{
			"id": "US-012",
			"title": "Implement PostgreSql ScheduledJobStorage",
			"description": "Implement IScheduledJobStorage for PostgreSQL",
			"size": "L",
			"acceptanceCriteria": [
				"All IScheduledJobStorage methods implemented",
				"Uses optimistic locking for job acquisition",
				"Handles concurrent access correctly"
			],
			"priority": 1,
			"phase": 2,
			"passes": false,
			"notes": ""
		},
		{
			"id": "US-013",
			"title": "Port CronScheduleCache from Ticker",
			"description": "Port cron parsing logic from Ticker to Messaging.Scheduling",
			"size": "S",
			"acceptanceCriteria": [
				"6-field cron parsing",
				"Timezone support",
				"Next occurrence calculation"
			],
			"priority": 1,
			"phase": 2,
			"passes": false,
			"notes": ""
		},
		{
			"id": "US-014",
			"title": "Create SchedulerBackgroundService",
			"description": "Create background service that polls for due jobs and dispatches to handlers",
			"size": "L",
			"acceptanceCriteria": [
				"Polls at configurable interval (default 1s)",
				"Dispatches to IConsume<ScheduledTrigger> handlers",
				"Handles graceful shutdown",
				"Respects distributed locks"
			],
			"priority": 1,
			"phase": 2,
			"passes": false,
			"notes": ""
		},
		{
			"id": "US-015",
			"title": "Create IScheduledJobManager",
			"description": "Create IScheduledJobManager for runtime job management",
			"size": "M",
			"acceptanceCriteria": [
				"Add/Update/Delete jobs",
				"Enable/Disable jobs",
				"Trigger immediate execution",
				"Query job status"
			],
			"priority": 2,
			"phase": 2,
			"passes": false,
			"notes": ""
		},
		{
			"id": "US-016",
			"title": "Integrate scheduler with MessageDispatcher",
			"description": "Integrate scheduler execution with existing MessageDispatcher for handler invocation",
			"size": "M",
			"acceptanceCriteria": [
				"ScheduledTrigger messages dispatched through MessageDispatcher",
				"Retry logic applies to scheduled jobs",
				"OpenTelemetry spans created"
			],
			"priority": 1,
			"phase": 2,
			"passes": false,
			"notes": ""
		},
		{
			"id": "US-017",
			"title": "Add distributed locking for job execution",
			"description": "Implement distributed locking to prevent concurrent job execution across instances",
			"size": "M",
			"acceptanceCriteria": [
				"Uses IResourceLockProvider if available",
				"Falls back to database-based locking",
				"Lock timeout configurable",
				"Automatic lock release on completion/failure"
			],
			"priority": 1,
			"phase": 2,
			"passes": false,
			"notes": ""
		},
		{
			"id": "US-018",
			"title": "Write scheduler unit tests",
			"description": "Write comprehensive unit tests for scheduler components",
			"size": "L",
			"acceptanceCriteria": [
				"Tests cron parsing",
				"Tests job polling",
				"Tests locking behavior",
				"Tests retry logic",
				">= 85% coverage"
			],
			"priority": 1,
			"phase": 2,
			"passes": false,
			"notes": ""
		},
		{
			"id": "US-019",
			"title": "Write scheduler PostgreSQL integration tests",
			"description": "Write integration tests for scheduler with PostgreSQL",
			"size": "M",
			"acceptanceCriteria": [
				"Tests job persistence",
				"Tests concurrent execution prevention",
				"Uses Testcontainers"
			],
			"priority": 1,
			"phase": 2,
			"passes": false,
			"notes": ""
		},
		{
			"id": "US-020",
			"title": "Extend source generator for [Recurring]",
			"description": "Extend existing Ticker source generator to scan [Recurring] on IConsume<ScheduledTrigger>",
			"size": "L",
			"acceptanceCriteria": [
				"Discovers [Recurring] attributes at compile time",
				"Generates job registration code",
				"Preserves existing Ticker generator patterns"
			],
			"priority": 2,
			"phase": 3,
			"passes": false,
			"notes": ""
		},
		{
			"id": "US-021",
			"title": "Generate job registration code",
			"description": "Generate compile-time job registration code from [Recurring] attributes",
			"size": "M",
			"acceptanceCriteria": [
				"Generates ModuleInitializer code",
				"Registers jobs with scheduler on startup",
				"Supports constructor injection"
			],
			"priority": 2,
			"phase": 3,
			"passes": false,
			"notes": ""
		},
		{
			"id": "US-022",
			"title": "Add [Recurring] usage analyzer",
			"description": "Add Roslyn analyzer to validate [Recurring] attribute usage",
			"size": "M",
			"acceptanceCriteria": [
				"Error if [Recurring] on non-IConsume<ScheduledTrigger>",
				"Warning for invalid cron expressions",
				"Code fix suggestions"
			],
			"priority": 3,
			"phase": 3,
			"passes": false,
			"notes": ""
		},
		{
			"id": "US-023",
			"title": "Design unified dashboard wireframes",
			"description": "Design wireframes for consolidated dashboard showing jobs + messages",
			"size": "S",
			"acceptanceCriteria": [
				"Combined overview page",
				"Separate tabs for jobs, published, received",
				"Unified status indicators"
			],
			"priority": 2,
			"phase": 4,
			"passes": false,
			"notes": ""
		},
		{
			"id": "US-024",
			"title": "Merge Ticker dashboard UI into Messaging.Dashboard",
			"description": "Merge Ticker dashboard React/Blazor components into Messaging.Dashboard",
			"size": "L",
			"acceptanceCriteria": [
				"All Ticker dashboard functionality preserved",
				"Unified styling/theming",
				"Single package output"
			],
			"priority": 2,
			"phase": 4,
			"passes": false,
			"notes": ""
		},
		{
			"id": "US-025",
			"title": "Create unified /api/jobs endpoints",
			"description": "Create REST endpoints for job management in unified dashboard",
			"size": "M",
			"acceptanceCriteria": [
				"GET/POST/PUT/DELETE for jobs",
				"Job execution history",
				"Trigger immediate run"
			],
			"priority": 2,
			"phase": 4,
			"passes": false,
			"notes": ""
		},
		{
			"id": "US-026",
			"title": "Add SignalR for real-time job updates",
			"description": "Add SignalR hub for real-time job status updates in dashboard",
			"size": "M",
			"acceptanceCriteria": [
				"Job start/complete notifications",
				"Active thread count updates",
				"Error notifications"
			],
			"priority": 3,
			"phase": 4,
			"passes": false,
			"notes": ""
		},
		{
			"id": "US-027",
			"title": "Implement DirectPublisher for Kafka",
			"description": "Implement DirectPublisher for Kafka transport",
			"size": "M",
			"acceptanceCriteria": [
				"Sends to Kafka without outbox",
				"Handles producer errors",
				"Integration tests pass"
			],
			"priority": 3,
			"phase": 5,
			"passes": false,
			"notes": ""
		},
		{
			"id": "US-028",
			"title": "Implement DirectPublisher for AWS SQS",
			"description": "Implement DirectPublisher for AWS SQS transport",
			"size": "M",
			"acceptanceCriteria": [
				"Sends to SQS without outbox",
				"Handles AWS errors",
				"Integration tests pass"
			],
			"priority": 3,
			"phase": 5,
			"passes": false,
			"notes": ""
		},
		{
			"id": "US-029",
			"title": "Implement DirectPublisher for Azure Service Bus",
			"description": "Implement DirectPublisher for Azure Service Bus transport",
			"size": "M",
			"acceptanceCriteria": [
				"Sends to Service Bus without outbox",
				"Handles Azure errors",
				"Integration tests pass"
			],
			"priority": 3,
			"phase": 5,
			"passes": false,
			"notes": ""
		},
		{
			"id": "US-030",
			"title": "Mark Ticker packages as deprecated",
			"description": "Mark all Headless.Ticker.* packages as deprecated in NuGet",
			"size": "S",
			"acceptanceCriteria": [
				"[Obsolete] attribute added",
				"Package description updated",
				"Points to unified packages"
			],
			"priority": 4,
			"phase": 6,
			"passes": false,
			"notes": ""
		},
		{
			"id": "US-031",
			"title": "Create migration guide documentation",
			"description": "Create documentation for migrating from Ticker to unified system",
			"size": "M",
			"acceptanceCriteria": [
				"Step-by-step migration guide",
				"Code examples before/after",
				"FAQ section"
			],
			"priority": 4,
			"phase": 6,
			"passes": false,
			"notes": ""
		}
	],
	"phases": [
		{
			"id": 1,
			"name": "Core Abstractions & Direct Publisher",
			"description": "Create core interfaces and implement direct publish for RabbitMQ",
			"estimatedHours": 16
		},
		{
			"id": 2,
			"name": "Scheduling Infrastructure",
			"description": "Create unified scheduling storage and background service",
			"estimatedHours": 32
		},
		{
			"id": 3,
			"name": "Source Generator Enhancement",
			"description": "Extend source generator for [Recurring] attribute",
			"estimatedHours": 18
		},
		{
			"id": 4,
			"name": "Dashboard Consolidation",
			"description": "Merge Ticker and Messaging dashboards",
			"estimatedHours": 24
		},
		{
			"id": 5,
			"name": "Direct Publisher for All Transports",
			"description": "Implement direct publish for remaining transports",
			"estimatedHours": 20
		},
		{
			"id": 6,
			"name": "Cleanup & Migration",
			"description": "Deprecate Ticker packages and create migration docs",
			"estimatedHours": 12
		}
	],
	"totalEstimatedHours": 122,
	"passes": false,
	"validation_errors": []
}
